# imports
from B2_ConverterHelpers import *

# csvFinFiles = getFinFiles("csv")

for yr in yrs:
    for lge in lges:
        print("")
        print(f" - - - {yr}, {lge} - - - ")
        rcFiles = getAnalyFiles(pdfDir, f"{yr}*Round_1*{lge}*RAC*nalysis.pdf")

        for file in rcFiles:
            for i in ses:
                if i in file:
                    sesType = i
            saveName, track = getSaveName(file, sesType)
            col, date = openPDF(file)
            rows = parsePDF(col, yr)
            const = [yr, date, lge, track, sesType]

            fRows = []
            for row in rows:
                fRow = fixRow(row)
                fRows.append(fRow)

            # fRows = fixRows(rows)
            chekRows(fRows, file)

########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################


            matrix = getMatrix(fRows, const)
            saveCSV(matrix, saveName)
            frequency = 500
            duration = 300
            Beep(frequency, duration)
            print(saveName)
            # csvFinFiles.append(file)
            # with open(f"{sveDir}csvFinFiles.txt", "w") as f:
            #     for i in csvFinFiles:
            #         f.write(i + "\\n")

            del rows
            del matrix

########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################

                    # if re.match("^\d{1,2}(st|nd|rd|th)$", col[0]["text"]) or re.match("^[a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð.]+$", line[0]["text"]):
                    #     print("all good")
                    #
                    # else:
                    #     print("##################################################################")
                    #     for i in col[:4]:
                    #         txt = i["text"]
                    #         loq = i["x0"]
                    #         print(f"{txt}       {loq}")
                    #     print("##################################################################")




                    #


